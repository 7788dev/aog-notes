# 部署指南

AOG Notes 可以部署到任何支持 Node.js 的平台。本文介绍几种常见的部署方式。

## 构建项目

在部署之前，先构建生产版本：

```bash
npm run build
```

构建完成后，可以使用以下命令在本地预览：

```bash
npm run start
```

## Vercel 部署

Vercel 是 Next.js 官方推荐的部署平台，提供免费额度。

### 步骤

1. 将代码推送到 GitHub
2. 访问 [vercel.com](https://vercel.com) 并登录
3. 点击 "New Project"
4. 导入你的 GitHub 仓库
5. 点击 "Deploy"

Vercel 会自动检测 Next.js 项目并完成部署。

### 自定义域名

在 Vercel 项目设置中，进入 "Domains" 页面添加自定义域名。

## Docker 部署

### Dockerfile

```dockerfile
FROM node:18-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM node:18-alpine AS runner
WORKDIR /app
ENV NODE_ENV production
COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

EXPOSE 3000
CMD ["node", "server.js"]
```

### 构建和运行

```bash
# 构建镜像
docker build -t easy-notes .

# 运行容器
docker run -p 3000:3000 easy-notes
```

## 静态导出

如果不需要服务端功能，可以导出为纯静态网站：

### 配置

在 `next.config.ts` 中添加：

```typescript
const nextConfig = {
  output: 'export',
}
```

### 导出

```bash
npm run build
```

构建完成后，`out/` 目录包含所有静态文件，可以部署到任何静态托管服务。

### 静态托管平台

- GitHub Pages
- Cloudflare Pages
- Netlify
- 阿里云 OSS
- 腾讯云 COS

## 环境变量

生产环境中，建议通过环境变量配置敏感信息：

```bash
# .env.production
NEXT_PUBLIC_SITE_URL=https://your-domain.com
```

## 性能优化

部署后建议检查以下优化项：

1. 启用 CDN 加速静态资源
2. 配置合适的缓存策略
3. 启用 Gzip/Brotli 压缩
4. 使用 HTTPS
